检测GPU分配...
使用环境变量中的GPU: 1 (主GPU: 1)
==========================================
DECODE网络训练 - 50 样本
开始时间: 2025年 07月 27日 星期日 16:36:14 CST
样本数: 50
训练轮数: 100
批处理大小: 4
学习率: 1e-4
GPU设备: 1
数据目录: /home/guest/Others/DECODE_rewrite/simulation_zmap2tiff/outputs_100samples_256
输出目录: /home/guest/Others/DECODE_rewrite/neuronal_network/training/outputs/train_50samples_20250727_163614
SLURM Job ID: 61
==========================================
分配TensorBoard端口...
启动TensorBoard在端口: 6077
TensorBoard PID: 3289383
开始训练...
使用GPU: 1 (CUDA_VISIBLE_DEVICES=1)
当前GPU状态:
1, NVIDIA GeForce RTX 3090, 11 MiB, 24576 MiB
开始训练DECODE网络:
  数据目录: /home/guest/Others/DECODE_rewrite/simulation_zmap2tiff/outputs_100samples_256
  样本数量: 50
  训练轮数: 100
  批次大小: 4
  学习率: 0.0001
  输出目录: /home/guest/Others/DECODE_rewrite/neuronal_network/training/outputs/train_50samples_20250727_163615

创建数据加载器...
训练样本: 80, 验证样本: 20
使用样本子集: 训练 40, 验证 10
找到 40 个有效样本
总共 2640 个训练样本
找到 10 个有效样本
总共 660 个训练样本
训练批次: 660, 验证批次: 165
使用设备: cuda
模型参数数量:
  第一级网络: 19,612,656
  第二级网络: 6,660,547
开始训练，共 100 个epoch
训练 Epoch 1:   0%|          | 0/660 [00:00<?, ?it/s]训练 Epoch 1:   0%|          | 0/660 [00:02<?, ?it/s, loss=2119151.7500, count=0.8274, loc=3.6365]训练 Epoch 1:   0%|          | 1/660 [00:02<31:14,  2.84s/it, loss=2119151.7500, count=0.8274, loc=3.6365]训练 Epoch 1:   0%|          | 1/660 [00:03<31:14,  2.84s/it, loss=2289981.2500, count=0.8295, loc=2.4001]训练 Epoch 1:   0%|          | 2/660 [00:03<18:35,  1.69s/it, loss=2289981.2500, count=0.8295, loc=2.4001]训练 Epoch 1:   0%|          | 2/660 [00:04<18:35,  1.69s/it, loss=2009436.8750, count=0.8413, loc=2.6898]训练 Epoch 1:   0%|          | 3/660 [00:04<13:36,  1.24s/it, loss=2009436.8750, count=0.8413, loc=2.6898]训练 Epoch 1:   0%|          | 3/660 [00:05<13:36,  1.24s/it, loss=2166824.7500, count=0.8418, loc=3.5122]训练 Epoch 1:   1%|          | 4/660 [00:05<11:08,  1.02s/it, loss=2166824.7500, count=0.8418, loc=3.5122]训练 Epoch 1:   1%|          | 4/660 [00:05<11:08,  1.02s/it, loss=2329023.0000, count=0.8356, loc=3.3282]训练 Epoch 1:   1%|          | 5/660 [00:05<10:22,  1.05it/s, loss=2329023.0000, count=0.8356, loc=3.3282]训练 Epoch 1:   1%|          | 5/660 [00:06<10:22,  1.05it/s, loss=2106377.2500, count=0.8462, loc=3.0362]训练 Epoch 1:   1%|          | 6/660 [00:06<09:23,  1.16it/s, loss=2106377.2500, count=0.8462, loc=3.0362]训练 Epoch 1:   1%|          | 6/660 [00:07<09:23,  1.16it/s, loss=2194920.5000, count=0.8314, loc=3.6573]训练 Epoch 1:   1%|          | 7/660 [00:07<09:06,  1.19it/s, loss=2194920.5000, count=0.8314, loc=3.6573]训练 Epoch 1:   1%|          | 7/660 [00:08<09:06,  1.19it/s, loss=1759073.7500, count=0.8396, loc=4.9014]训练 Epoch 1:   1%|          | 8/660 [00:08<08:31,  1.27it/s, loss=1759073.7500, count=0.8396, loc=4.9014]训练 Epoch 1:   1%|          | 8/660 [00:08<08:31,  1.27it/s, loss=2230328.0000, count=0.8411, loc=4.3294]训练 Epoch 1:   1%|▏         | 9/660 [00:08<08:16,  1.31it/s, loss=2230328.0000, count=0.8411, loc=4.3294]训练 Epoch 1:   1%|▏         | 9/660 [00:09<08:16,  1.31it/s, loss=1868156.0000, count=0.8407, loc=5.2978]训练 Epoch 1:   2%|▏         | 10/660 [00:09<08:06,  1.34it/s, loss=1868156.0000, count=0.8407, loc=5.2978]训练 Epoch 1:   2%|▏         | 10/660 [00:10<08:06,  1.34it/s, loss=1838408.3750, count=0.8332, loc=6.0455]训练 Epoch 1:   2%|▏         | 11/660 [00:10<08:10,  1.32it/s, loss=1838408.3750, count=0.8332, loc=6.0455]训练 Epoch 1:   2%|▏         | 11/660 [00:11<08:10,  1.32it/s, loss=2653835.5000, count=0.8280, loc=8.1343]训练 Epoch 1:   2%|▏         | 12/660 [00:11<08:20,  1.29it/s, loss=2653835.5000, count=0.8280, loc=8.1343]训练 Epoch 1:   2%|▏         | 12/660 [00:11<08:20,  1.29it/s, loss=2608027.2500, count=0.8179, loc=7.0408]训练 Epoch 1:   2%|▏         | 13/660 [00:11<08:37,  1.25it/s, loss=2608027.2500, count=0.8179, loc=7.0408]训练 Epoch 1:   2%|▏         | 13/660 [00:12<08:37,  1.25it/s, loss=2361572.0000, count=0.8214, loc=9.5938]训练 Epoch 1:   2%|▏         | 14/660 [00:12<08:51,  1.21it/s, loss=2361572.0000, count=0.8214, loc=9.5938]训练 Epoch 1:   2%|▏         | 14/660 [00:13<08:51,  1.21it/s, loss=2248260.0000, count=0.8224, loc=9.9645]训练 Epoch 1:   2%|▏         | 15/660 [00:13<08:37,  1.25it/s, loss=2248260.0000, count=0.8224, loc=9.9645]训练 Epoch 1:   2%|▏         | 15/660 [00:14<08:37,  1.25it/s, loss=2213704.7500, count=0.8150, loc=11.6814]训练 Epoch 1:   2%|▏         | 16/660 [00:14<08:30,  1.26it/s, loss=2213704.7500, count=0.8150, loc=11.6814]训练 Epoch 1:   2%|▏         | 16/660 [00:15<08:30,  1.26it/s, loss=2261928.2500, count=0.8074, loc=16.4353]训练 Epoch 1:   3%|▎         | 17/660 [00:15<08:04,  1.33it/s, loss=2261928.2500, count=0.8074, loc=16.4353]训练 Epoch 1:   3%|▎         | 17/660 [00:15<08:04,  1.33it/s, loss=2364229.7500, count=0.8067, loc=16.8727]训练 Epoch 1:   3%|▎         | 18/660 [00:15<07:45,  1.38it/s, loss=2364229.7500, count=0.8067, loc=16.8727]训练 Epoch 1:   3%|▎         | 18/660 [00:16<07:45,  1.38it/s, loss=1908649.6250, count=0.8374, loc=1.5728] 训练 Epoch 1:   3%|▎         | 19/660 [00:16<07:34,  1.41it/s, loss=1908649.6250, count=0.8374, loc=1.5728]训练 Epoch 1:   3%|▎         | 19/660 [00:17<07:34,  1.41it/s, loss=2548254.7500, count=0.8056, loc=18.5166]训练 Epoch 1:   3%|▎         | 20/660 [00:17<07:28,  1.43it/s, loss=2548254.7500, count=0.8056, loc=18.5166]训练 Epoch 1:   3%|▎         | 20/660 [00:17<07:28,  1.43it/s, loss=2188119.7500, count=0.8058, loc=15.5617]训练 Epoch 1:   3%|▎         | 21/660 [00:17<07:24,  1.44it/s, loss=2188119.7500, count=0.8058, loc=15.5617]训练 Epoch 1:   3%|▎         | 21/660 [00:18<07:24,  1.44it/s, loss=1747948.2500, count=0.7904, loc=22.6339]训练 Epoch 1:   3%|▎         | 22/660 [00:18<07:17,  1.46it/s, loss=1747948.2500, count=0.7904, loc=22.6339]训练 Epoch 1:   3%|▎         | 22/660 [00:19<07:17,  1.46it/s, loss=2117253.0000, count=0.7855, loc=23.0944]训练 Epoch 1:   3%|▎         | 23/660 [00:19<07:27,  1.42it/s, loss=2117253.0000, count=0.7855, loc=23.0944]训练 Epoch 1:   3%|▎         | 23/660 [00:19<07:27,  1.42it/s, loss=2426552.5000, count=0.7847, loc=23.4379]训练 Epoch 1:   4%|▎         | 24/660 [00:19<07:50,  1.35it/s, loss=2426552.5000, count=0.7847, loc=23.4379]训练 Epoch 1:   4%|▎         | 24/660 [00:20<07:50,  1.35it/s, loss=2176937.7500, count=0.7791, loc=26.2886]训练 Epoch 1:   4%|▍         | 25/660 [00:20<07:47,  1.36it/s, loss=2176937.7500, count=0.7791, loc=26.2886]训练 Epoch 1:   4%|▍         | 25/660 [00:21<07:47,  1.36it/s, loss=1935662.3750, count=0.7834, loc=27.3568]训练 Epoch 1:   4%|▍         | 26/660 [00:21<08:01,  1.32it/s, loss=1935662.3750, count=0.7834, loc=27.3568]训练 Epoch 1:   4%|▍         | 26/660 [00:22<08:01,  1.32it/s, loss=2234063.0000, count=0.7858, loc=28.6560]训练 Epoch 1:   4%|▍         | 27/660 [00:22<07:57,  1.32it/s, loss=2234063.0000, count=0.7858, loc=28.6560]训练 Epoch 1:   4%|▍         | 27/660 [00:22<07:57,  1.32it/s, loss=1635703.2500, count=0.7813, loc=35.1702]训练 Epoch 1:   4%|▍         | 28/660 [00:22<07:55,  1.33it/s, loss=1635703.2500, count=0.7813, loc=35.1702]训练 Epoch 1:   4%|▍         | 28/660 [00:23<07:55,  1.33it/s, loss=1962538.6250, count=0.7796, loc=32.5270]训练 Epoch 1:   4%|▍         | 29/660 [00:23<07:52,  1.34it/s, loss=1962538.6250, count=0.7796, loc=32.5270]训练 Epoch 1:   4%|▍         | 29/660 [00:24<07:52,  1.34it/s, loss=2146218.7500, count=0.7789, loc=29.4112]训练 Epoch 1:   5%|▍         | 30/660 [00:24<07:53,  1.33it/s, loss=2146218.7500, count=0.7789, loc=29.4112]训练 Epoch 1:   5%|▍         | 30/660 [00:25<07:53,  1.33it/s, loss=2191792.2500, count=0.7796, loc=25.3121]训练 Epoch 1:   5%|▍         | 31/660 [00:25<07:57,  1.32it/s, loss=2191792.2500, count=0.7796, loc=25.3121]训练 Epoch 1:   5%|▍         | 31/660 [00:25<07:57,  1.32it/s, loss=1841763.8750, count=0.7839, loc=30.0167]训练 Epoch 1:   5%|▍         | 32/660 [00:25<07:45,  1.35it/s, loss=1841763.8750, count=0.7839, loc=30.0167]训练 Epoch 1:   5%|▍         | 32/660 [00:26<07:45,  1.35it/s, loss=2141720.5000, count=0.7730, loc=22.1716]训练 Epoch 1:   5%|▌         | 33/660 [00:26<08:12,  1.27it/s, loss=2141720.5000, count=0.7730, loc=22.1716]训练 Epoch 1:   5%|▌         | 33/660 [00:27<08:12,  1.27it/s, loss=2126834.0000, count=0.7739, loc=28.1088]训练 Epoch 1:   5%|▌         | 34/660 [00:27<08:02,  1.30it/s, loss=2126834.0000, count=0.7739, loc=28.1088]训练 Epoch 1:   5%|▌         | 34/660 [00:28<08:02,  1.30it/s, loss=1897794.7500, count=0.7808, loc=28.0223]训练 Epoch 1:   5%|▌         | 35/660 [00:28<07:27,  1.40it/s, loss=1897794.7500, count=0.7808, loc=28.0223]训练 Epoch 1:   5%|▌         | 35/660 [00:28<07:27,  1.40it/s, loss=2049108.0000, count=0.7697, loc=31.7266]训练 Epoch 1:   5%|▌         | 36/660 [00:28<07:16,  1.43it/s, loss=2049108.0000, count=0.7697, loc=31.7266]训练 Epoch 1:   5%|▌         | 36/660 [00:29<07:16,  1.43it/s, loss=2165972.2500, count=0.7670, loc=27.8977]训练 Epoch 1:   6%|▌         | 37/660 [00:29<07:26,  1.40it/s, loss=2165972.2500, count=0.7670, loc=27.8977]训练 Epoch 1:   6%|▌         | 37/660 [00:30<07:26,  1.40it/s, loss=1815381.6250, count=0.7689, loc=30.3297]训练 Epoch 1:   6%|▌         | 38/660 [00:30<07:15,  1.43it/s, loss=1815381.6250, count=0.7689, loc=30.3297]训练 Epoch 1:   6%|▌         | 38/660 [00:30<07:15,  1.43it/s, loss=2039820.5000, count=0.7698, loc=27.7593]训练 Epoch 1:   6%|▌         | 39/660 [00:30<07:12,  1.44it/s, loss=2039820.5000, count=0.7698, loc=27.7593]训练 Epoch 1:   6%|▌         | 39/660 [00:31<07:12,  1.44it/s, loss=1820307.3750, count=0.7706, loc=27.2067]训练 Epoch 1:   6%|▌         | 40/660 [00:31<07:13,  1.43it/s, loss=1820307.3750, count=0.7706, loc=27.2067]训练 Epoch 1:   6%|▌         | 40/660 [00:32<07:13,  1.43it/s, loss=1791994.5000, count=0.7688, loc=32.9247]训练 Epoch 1:   6%|▌         | 41/660 [00:32<06:58,  1.48it/s, loss=1791994.5000, count=0.7688, loc=32.9247]训练 Epoch 1:   6%|▌         | 41/660 [00:32<06:58,  1.48it/s, loss=2009225.7500, count=0.7688, loc=28.5574]训练 Epoch 1:   6%|▋         | 42/660 [00:32<07:02,  1.46it/s, loss=2009225.7500, count=0.7688, loc=28.5574]训练 Epoch 1:   6%|▋         | 42/660 [00:33<07:02,  1.46it/s, loss=1775392.8750, count=0.7725, loc=27.4029]训练 Epoch 1:   7%|▋         | 43/660 [00:33<07:01,  1.46it/s, loss=1775392.8750, count=0.7725, loc=27.4029]训练 Epoch 1:   7%|▋         | 43/660 [00:34<07:01,  1.46it/s, loss=1625329.0000, count=0.7781, loc=25.2903]训练 Epoch 1:   7%|▋         | 44/660 [00:34<06:56,  1.48it/s, loss=1625329.0000, count=0.7781, loc=25.2903]训练 Epoch 1:   7%|▋         | 44/660 [00:35<06:56,  1.48it/s, loss=2282533.5000, count=0.7648, loc=25.2115]训练 Epoch 1:   7%|▋         | 45/660 [00:35<07:06,  1.44it/s, loss=2282533.5000, count=0.7648, loc=25.2115]训练 Epoch 1:   7%|▋         | 45/660 [00:35<07:06,  1.44it/s, loss=1880338.3750, count=0.7734, loc=28.6986]训练 Epoch 1:   7%|▋         | 46/660 [00:35<07:03,  1.45it/s, loss=1880338.3750, count=0.7734, loc=28.6986]训练 Epoch 1:   7%|▋         | 46/660 [00:36<07:03,  1.45it/s, loss=2130151.7500, count=0.7642, loc=29.4367]训练 Epoch 1:   7%|▋         | 47/660 [00:36<06:50,  1.49it/s, loss=2130151.7500, count=0.7642, loc=29.4367]训练 Epoch 1:   7%|▋         | 47/660 [00:37<06:50,  1.49it/s, loss=2158278.2500, count=0.7638, loc=23.9322]训练 Epoch 1:   7%|▋         | 48/660 [00:37<07:02,  1.45it/s, loss=2158278.2500, count=0.7638, loc=23.9322]训练 Epoch 1:   7%|▋         | 48/660 [00:37<07:02,  1.45it/s, loss=2163062.2500, count=0.7636, loc=23.4680]训练 Epoch 1:   7%|▋         | 49/660 [00:37<07:07,  1.43it/s, loss=2163062.2500, count=0.7636, loc=23.4680]训练 Epoch 1:   7%|▋         | 49/660 [00:38<07:07,  1.43it/s, loss=1853494.6250, count=0.7632, loc=20.5881]训练 Epoch 1:   8%|▊         | 50/660 [00:38<07:24,  1.37it/s, loss=1853494.6250, count=0.7632, loc=20.5881]训练 Epoch 1:   8%|▊         | 50/660 [00:39<07:24,  1.37it/s, loss=2008975.0000, count=0.7655, loc=27.5863]训练 Epoch 1:   8%|▊         | 51/660 [00:39<07:29,  1.35it/s, loss=2008975.0000, count=0.7655, loc=27.5863]训练 Epoch 1:   8%|▊         | 51/660 [00:40<07:29,  1.35it/s, loss=2142342.5000, count=0.7598, loc=23.0348]训练 Epoch 1:   8%|▊         | 52/660 [00:40<07:32,  1.34it/s, loss=2142342.5000, count=0.7598, loc=23.0348]训练 Epoch 1:   8%|▊         | 52/660 [00:40<07:32,  1.34it/s, loss=1788808.8750, count=0.7678, loc=24.1942]训练 Epoch 1:   8%|▊         | 53/660 [00:40<07:09,  1.41it/s, loss=1788808.8750, count=0.7678, loc=24.1942]训练 Epoch 1:   8%|▊         | 53/660 [00:41<07:09,  1.41it/s, loss=2210586.7500, count=0.7629, loc=19.0443]训练 Epoch 1:   8%|▊         | 54/660 [00:41<07:18,  1.38it/s, loss=2210586.7500, count=0.7629, loc=19.0443]训练 Epoch 1:   8%|▊         | 54/660 [00:42<07:18,  1.38it/s, loss=2364179.7500, count=0.7617, loc=26.5733]训练 Epoch 1:   8%|▊         | 55/660 [00:42<07:11,  1.40it/s, loss=2364179.7500, count=0.7617, loc=26.5733]训练 Epoch 1:   8%|▊         | 55/660 [00:42<07:11,  1.40it/s, loss=2576945.5000, count=0.7622, loc=26.9642]训练 Epoch 1:   8%|▊         | 56/660 [00:42<07:12,  1.40it/s, loss=2576945.5000, count=0.7622, loc=26.9642]训练 Epoch 1:   8%|▊         | 56/660 [00:43<07:12,  1.40it/s, loss=2351819.5000, count=0.7586, loc=24.6550]训练 Epoch 1:   9%|▊         | 57/660 [00:43<07:12,  1.39it/s, loss=2351819.5000, count=0.7586, loc=24.6550]训练 Epoch 1:   9%|▊         | 57/660 [00:44<07:12,  1.39it/s, loss=2293085.7500, count=0.7600, loc=19.9568]训练 Epoch 1:   9%|▉         | 58/660 [00:44<07:13,  1.39it/s, loss=2293085.7500, count=0.7600, loc=19.9568]训练 Epoch 1:   9%|▉         | 58/660 [00:45<07:13,  1.39it/s, loss=2174871.0000, count=0.7618, loc=25.4723]训练 Epoch 1:   9%|▉         | 59/660 [00:45<06:59,  1.43it/s, loss=2174871.0000, count=0.7618, loc=25.4723]训练 Epoch 1:   9%|▉         | 59/660 [00:45<06:59,  1.43it/s, loss=1990390.0000, count=0.7591, loc=22.9330]训练 Epoch 1:   9%|▉         | 60/660 [00:45<06:46,  1.48it/s, loss=1990390.0000, count=0.7591, loc=22.9330]