2025-07-23 23:32:19,289 - INFO - 开始运行相位恢复流程...
2025-07-23 23:32:19,289 - INFO - Loading configuration...
2025-07-23 23:32:19,289 - INFO - Loading camera parameters...
2025-07-23 23:32:19,289 - INFO - Loading TIFF stack: ../beads/spool_100mW_30ms_3D_1_2/spool_100mW_30ms_3D_1_2_MMStack_Default.ome.tif
2025-07-23 23:32:19,295 - INFO - Stack shape: (201, 512, 512)
2025-07-23 23:32:19,296 - INFO - Detecting emitters...
2025-07-23 23:32:19,365 - INFO - Detected 38 emitter candidates
2025-07-23 23:32:19,368 - INFO - After filtering: 38 emitters
2025-07-23 23:32:19,373 - INFO - Processing emitter 1/38 at (174, 333)
2025-07-23 23:32:19,381 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:19,388 - INFO - Iteration 01: mean NCC = -0.0945
2025-07-23 23:32:19,396 - INFO - Iteration 02: mean NCC = 0.6211
2025-07-23 23:32:19,403 - INFO - Iteration 03: mean NCC = 0.6950
2025-07-23 23:32:19,409 - INFO - Iteration 04: mean NCC = 0.7120
2025-07-23 23:32:19,410 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:19,410 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:19,412 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:19,470 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:19,476 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:20,031 - INFO - PSF comparison figure saved to result/psf_comparison.png
2025-07-23 23:32:20,965 - INFO - 5-frame comparison figure saved to result/psf_comparison_five.png
2025-07-23 23:32:21,280 - INFO - Zernike coefficients figure saved to result/zernike_coefficients.png
2025-07-23 23:32:21,280 - INFO - Processing emitter 2/38 at (304, 434)
2025-07-23 23:32:21,292 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:21,298 - INFO - Iteration 01: mean NCC = -0.0945
2025-07-23 23:32:21,304 - INFO - Iteration 02: mean NCC = 0.6197
2025-07-23 23:32:21,309 - INFO - Iteration 03: mean NCC = 0.6950
2025-07-23 23:32:21,314 - INFO - Iteration 04: mean NCC = 0.7121
2025-07-23 23:32:21,315 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:21,315 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:21,316 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:21,327 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:21,331 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:21,334 - INFO - Processing emitter 3/38 at (127, 460)
2025-07-23 23:32:21,346 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:21,352 - INFO - Iteration 01: mean NCC = -0.0944
2025-07-23 23:32:21,357 - INFO - Iteration 02: mean NCC = 0.6189
2025-07-23 23:32:21,362 - INFO - Iteration 03: mean NCC = 0.6946
2025-07-23 23:32:21,368 - INFO - Iteration 04: mean NCC = 0.7117
2025-07-23 23:32:21,368 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:21,368 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:21,370 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:21,380 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:21,385 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:21,387 - INFO - Processing emitter 4/38 at (294, 375)
2025-07-23 23:32:21,400 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:21,405 - INFO - Iteration 01: mean NCC = -0.0943
2025-07-23 23:32:21,410 - INFO - Iteration 02: mean NCC = 0.6197
2025-07-23 23:32:21,416 - INFO - Iteration 03: mean NCC = 0.6948
2025-07-23 23:32:21,421 - INFO - Iteration 04: mean NCC = 0.7121
2025-07-23 23:32:21,421 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:21,421 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:21,423 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:21,433 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:21,438 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:21,440 - INFO - Processing emitter 5/38 at (255, 65)
2025-07-23 23:32:21,453 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:21,458 - INFO - Iteration 01: mean NCC = -0.0942
2025-07-23 23:32:21,463 - INFO - Iteration 02: mean NCC = 0.6198
2025-07-23 23:32:21,469 - INFO - Iteration 03: mean NCC = 0.6948
2025-07-23 23:32:21,474 - INFO - Iteration 04: mean NCC = 0.7121
2025-07-23 23:32:21,474 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:21,474 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:21,476 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:21,486 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:21,490 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:21,493 - INFO - Processing emitter 6/38 at (120, 412)
2025-07-23 23:32:21,506 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:21,511 - INFO - Iteration 01: mean NCC = -0.0942
2025-07-23 23:32:21,516 - INFO - Iteration 02: mean NCC = 0.6194
2025-07-23 23:32:21,522 - INFO - Iteration 03: mean NCC = 0.6948
2025-07-23 23:32:21,527 - INFO - Iteration 04: mean NCC = 0.7122
2025-07-23 23:32:21,527 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:21,527 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:21,529 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:21,539 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:21,543 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:21,546 - INFO - Processing emitter 7/38 at (355, 483)
2025-07-23 23:32:21,559 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:21,564 - INFO - Iteration 01: mean NCC = -0.0940
2025-07-23 23:32:21,570 - INFO - Iteration 02: mean NCC = 0.6200
2025-07-23 23:32:21,575 - INFO - Iteration 03: mean NCC = 0.6946
2025-07-23 23:32:21,580 - INFO - Iteration 04: mean NCC = 0.7120
2025-07-23 23:32:21,581 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:21,581 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:21,582 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:21,592 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:21,597 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:21,599 - INFO - Processing emitter 8/38 at (344, 155)
2025-07-23 23:32:21,613 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:21,618 - INFO - Iteration 01: mean NCC = -0.0939
2025-07-23 23:32:21,623 - INFO - Iteration 02: mean NCC = 0.6184
2025-07-23 23:32:21,629 - INFO - Iteration 03: mean NCC = 0.6953
2025-07-23 23:32:21,634 - INFO - Iteration 04: mean NCC = 0.7131
2025-07-23 23:32:21,634 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:21,634 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:21,636 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:21,646 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:21,651 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:21,653 - INFO - Processing emitter 9/38 at (455, 486)
2025-07-23 23:32:21,667 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:21,672 - INFO - Iteration 01: mean NCC = -0.0938
2025-07-23 23:32:21,677 - INFO - Iteration 02: mean NCC = 0.6204
2025-07-23 23:32:21,683 - INFO - Iteration 03: mean NCC = 0.6956
2025-07-23 23:32:21,688 - INFO - Iteration 04: mean NCC = 0.7132
2025-07-23 23:32:21,688 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:21,689 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:21,690 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:21,700 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:21,705 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:21,707 - INFO - Processing emitter 10/38 at (214, 320)
2025-07-23 23:32:21,722 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:21,727 - INFO - Iteration 01: mean NCC = -0.0938
2025-07-23 23:32:21,732 - INFO - Iteration 02: mean NCC = 0.6196
2025-07-23 23:32:21,738 - INFO - Iteration 03: mean NCC = 0.6949
2025-07-23 23:32:21,743 - INFO - Iteration 04: mean NCC = 0.7126
2025-07-23 23:32:21,743 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:21,743 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:21,745 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:21,755 - INFO -   Fitted Gaussian sigma = 0.35 px
2025-07-23 23:32:21,760 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:21,762 - INFO - Processing emitter 11/38 at (334, 215)
2025-07-23 23:32:21,773 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:21,778 - INFO - Iteration 01: mean NCC = -0.0939
2025-07-23 23:32:21,783 - INFO - Iteration 02: mean NCC = 0.6197
2025-07-23 23:32:21,789 - INFO - Iteration 03: mean NCC = 0.6946
2025-07-23 23:32:21,794 - INFO - Iteration 04: mean NCC = 0.7121
2025-07-23 23:32:21,794 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:21,794 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:21,796 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:21,806 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:21,810 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:21,813 - INFO - Processing emitter 12/38 at (214, 470)
2025-07-23 23:32:21,824 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:21,829 - INFO - Iteration 01: mean NCC = -0.0935
2025-07-23 23:32:21,835 - INFO - Iteration 02: mean NCC = 0.6207
2025-07-23 23:32:21,840 - INFO - Iteration 03: mean NCC = 0.6962
2025-07-23 23:32:21,845 - INFO - Iteration 04: mean NCC = 0.7145
2025-07-23 23:32:21,846 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:21,846 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:21,847 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:21,858 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:21,862 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:21,865 - INFO - Processing emitter 13/38 at (163, 105)
2025-07-23 23:32:21,877 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:21,882 - INFO - Iteration 01: mean NCC = -0.0930
2025-07-23 23:32:21,887 - INFO - Iteration 02: mean NCC = 0.6209
2025-07-23 23:32:21,893 - INFO - Iteration 03: mean NCC = 0.6958
2025-07-23 23:32:21,898 - INFO - Iteration 04: mean NCC = 0.7141
2025-07-23 23:32:21,898 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:21,898 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:21,900 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:21,911 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:21,915 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:21,918 - INFO - Processing emitter 14/38 at (124, 384)
2025-07-23 23:32:21,930 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:21,936 - INFO - Iteration 01: mean NCC = -0.0807
2025-07-23 23:32:21,941 - INFO - Iteration 02: mean NCC = 0.3268
2025-07-23 23:32:21,946 - INFO - Iteration 03: mean NCC = 0.4659
2025-07-23 23:32:21,952 - INFO - Iteration 04: mean NCC = 0.5168
2025-07-23 23:32:21,957 - INFO - Iteration 05: mean NCC = 0.5618
2025-07-23 23:32:21,962 - INFO - Iteration 06: mean NCC = 0.6096
2025-07-23 23:32:21,968 - INFO - Iteration 07: mean NCC = 0.6512
2025-07-23 23:32:21,973 - INFO - Iteration 08: mean NCC = 0.6779
2025-07-23 23:32:21,978 - INFO - Iteration 09: mean NCC = 0.6948
2025-07-23 23:32:21,984 - INFO - Iteration 10: mean NCC = 0.7038
2025-07-23 23:32:21,984 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:21,984 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:21,985 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:21,996 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,000 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,003 - INFO - Processing emitter 15/38 at (86, 240)
2025-07-23 23:32:22,016 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,021 - INFO - Iteration 01: mean NCC = -0.0927
2025-07-23 23:32:22,027 - INFO - Iteration 02: mean NCC = 0.6207
2025-07-23 23:32:22,032 - INFO - Iteration 03: mean NCC = 0.6950
2025-07-23 23:32:22,037 - INFO - Iteration 04: mean NCC = 0.7135
2025-07-23 23:32:22,037 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,037 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,039 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,050 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,054 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,057 - INFO - Processing emitter 16/38 at (369, 74)
2025-07-23 23:32:22,070 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,075 - INFO - Iteration 01: mean NCC = -0.1139
2025-07-23 23:32:22,081 - INFO - Iteration 02: mean NCC = 0.6175
2025-07-23 23:32:22,086 - INFO - Iteration 03: mean NCC = 0.6612
2025-07-23 23:32:22,091 - INFO - Iteration 04: mean NCC = 0.6592
2025-07-23 23:32:22,097 - INFO - Iteration 05: mean NCC = 0.6670
2025-07-23 23:32:22,102 - INFO - Iteration 06: mean NCC = 0.6829
2025-07-23 23:32:22,107 - INFO - Iteration 07: mean NCC = 0.6989
2025-07-23 23:32:22,113 - INFO - Iteration 08: mean NCC = 0.7115
2025-07-23 23:32:22,113 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,113 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,114 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,125 - INFO -   Fitted Gaussian sigma = 0.30 px
2025-07-23 23:32:22,129 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,132 - INFO - Processing emitter 17/38 at (468, 301)
2025-07-23 23:32:22,146 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,151 - INFO - Iteration 01: mean NCC = -0.0912
2025-07-23 23:32:22,156 - INFO - Iteration 02: mean NCC = 0.6225
2025-07-23 23:32:22,162 - INFO - Iteration 03: mean NCC = 0.6961
2025-07-23 23:32:22,167 - INFO - Iteration 04: mean NCC = 0.7152
2025-07-23 23:32:22,167 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,167 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,169 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,179 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,184 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,186 - INFO - Processing emitter 18/38 at (131, 96)
2025-07-23 23:32:22,200 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,206 - INFO - Iteration 01: mean NCC = -0.0922
2025-07-23 23:32:22,211 - INFO - Iteration 02: mean NCC = 0.6226
2025-07-23 23:32:22,216 - INFO - Iteration 03: mean NCC = 0.6957
2025-07-23 23:32:22,222 - INFO - Iteration 04: mean NCC = 0.7147
2025-07-23 23:32:22,222 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,222 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,224 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,234 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,239 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,241 - INFO - Processing emitter 19/38 at (414, 78)
2025-07-23 23:32:22,256 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,261 - INFO - Iteration 01: mean NCC = -0.0918
2025-07-23 23:32:22,266 - INFO - Iteration 02: mean NCC = 0.6219
2025-07-23 23:32:22,272 - INFO - Iteration 03: mean NCC = 0.6953
2025-07-23 23:32:22,277 - INFO - Iteration 04: mean NCC = 0.7145
2025-07-23 23:32:22,277 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,277 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,279 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,289 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,293 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,296 - INFO - Processing emitter 20/38 at (261, 362)
2025-07-23 23:32:22,311 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,316 - INFO - Iteration 01: mean NCC = -0.0918
2025-07-23 23:32:22,322 - INFO - Iteration 02: mean NCC = 0.6252
2025-07-23 23:32:22,327 - INFO - Iteration 03: mean NCC = 0.6960
2025-07-23 23:32:22,332 - INFO - Iteration 04: mean NCC = 0.7147
2025-07-23 23:32:22,332 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,332 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,334 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,345 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,349 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,351 - INFO - Processing emitter 21/38 at (75, 388)
2025-07-23 23:32:22,362 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,368 - INFO - Iteration 01: mean NCC = -0.0916
2025-07-23 23:32:22,373 - INFO - Iteration 02: mean NCC = 0.6256
2025-07-23 23:32:22,378 - INFO - Iteration 03: mean NCC = 0.6965
2025-07-23 23:32:22,384 - INFO - Iteration 04: mean NCC = 0.7158
2025-07-23 23:32:22,384 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,384 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,385 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,396 - INFO -   Fitted Gaussian sigma = 0.35 px
2025-07-23 23:32:22,401 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,403 - INFO - Processing emitter 22/38 at (376, 255)
2025-07-23 23:32:22,415 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,420 - INFO - Iteration 01: mean NCC = -0.0912
2025-07-23 23:32:22,425 - INFO - Iteration 02: mean NCC = 0.6266
2025-07-23 23:32:22,431 - INFO - Iteration 03: mean NCC = 0.6965
2025-07-23 23:32:22,436 - INFO - Iteration 04: mean NCC = 0.7161
2025-07-23 23:32:22,436 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,436 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,438 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,448 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,453 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,455 - INFO - Processing emitter 23/38 at (159, 45)
2025-07-23 23:32:22,467 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,472 - INFO - Iteration 01: mean NCC = -0.0909
2025-07-23 23:32:22,478 - INFO - Iteration 02: mean NCC = 0.6256
2025-07-23 23:32:22,483 - INFO - Iteration 03: mean NCC = 0.6961
2025-07-23 23:32:22,488 - INFO - Iteration 04: mean NCC = 0.7159
2025-07-23 23:32:22,489 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,489 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,490 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,501 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,505 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,507 - INFO - Processing emitter 24/38 at (225, 352)
2025-07-23 23:32:22,520 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,525 - INFO - Iteration 01: mean NCC = -0.0909
2025-07-23 23:32:22,530 - INFO - Iteration 02: mean NCC = 0.6278
2025-07-23 23:32:22,535 - INFO - Iteration 03: mean NCC = 0.6967
2025-07-23 23:32:22,541 - INFO - Iteration 04: mean NCC = 0.7164
2025-07-23 23:32:22,541 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,541 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,543 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,553 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,557 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,560 - INFO - Processing emitter 25/38 at (369, 351)
2025-07-23 23:32:22,572 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,577 - INFO - Iteration 01: mean NCC = -0.0908
2025-07-23 23:32:22,583 - INFO - Iteration 02: mean NCC = 0.6264
2025-07-23 23:32:22,588 - INFO - Iteration 03: mean NCC = 0.6958
2025-07-23 23:32:22,593 - INFO - Iteration 04: mean NCC = 0.7158
2025-07-23 23:32:22,594 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,594 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,595 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,607 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,611 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,614 - INFO - Processing emitter 26/38 at (431, 255)
2025-07-23 23:32:22,626 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,632 - INFO - Iteration 01: mean NCC = -0.0906
2025-07-23 23:32:22,637 - INFO - Iteration 02: mean NCC = 0.6276
2025-07-23 23:32:22,642 - INFO - Iteration 03: mean NCC = 0.6958
2025-07-23 23:32:22,648 - INFO - Iteration 04: mean NCC = 0.7158
2025-07-23 23:32:22,648 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,648 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,649 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,660 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,664 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,667 - INFO - Processing emitter 27/38 at (68, 186)
2025-07-23 23:32:22,680 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,685 - INFO - Iteration 01: mean NCC = -0.0905
2025-07-23 23:32:22,690 - INFO - Iteration 02: mean NCC = 0.6308
2025-07-23 23:32:22,695 - INFO - Iteration 03: mean NCC = 0.6971
2025-07-23 23:32:22,701 - INFO - Iteration 04: mean NCC = 0.7171
2025-07-23 23:32:22,701 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,701 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,703 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,713 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,717 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,720 - INFO - Processing emitter 28/38 at (38, 266)
2025-07-23 23:32:22,733 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,738 - INFO - Iteration 01: mean NCC = -0.0903
2025-07-23 23:32:22,744 - INFO - Iteration 02: mean NCC = 0.6298
2025-07-23 23:32:22,749 - INFO - Iteration 03: mean NCC = 0.6958
2025-07-23 23:32:22,754 - INFO - Iteration 04: mean NCC = 0.7155
2025-07-23 23:32:22,754 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,754 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,756 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,766 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,771 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,773 - INFO - Processing emitter 29/38 at (59, 473)
2025-07-23 23:32:22,787 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,792 - INFO - Iteration 01: mean NCC = -0.0903
2025-07-23 23:32:22,797 - INFO - Iteration 02: mean NCC = 0.6306
2025-07-23 23:32:22,803 - INFO - Iteration 03: mean NCC = 0.6969
2025-07-23 23:32:22,808 - INFO - Iteration 04: mean NCC = 0.7170
2025-07-23 23:32:22,808 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,808 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,810 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,821 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,826 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,828 - INFO - Processing emitter 30/38 at (57, 72)
2025-07-23 23:32:22,842 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,847 - INFO - Iteration 01: mean NCC = -0.0902
2025-07-23 23:32:22,853 - INFO - Iteration 02: mean NCC = 0.6285
2025-07-23 23:32:22,858 - INFO - Iteration 03: mean NCC = 0.6951
2025-07-23 23:32:22,863 - INFO - Iteration 04: mean NCC = 0.7150
2025-07-23 23:32:22,863 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,863 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,865 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,875 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,880 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,882 - INFO - Processing emitter 31/38 at (194, 212)
2025-07-23 23:32:22,892 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,897 - INFO - Iteration 01: mean NCC = -0.0902
2025-07-23 23:32:22,903 - INFO - Iteration 02: mean NCC = 0.6296
2025-07-23 23:32:22,908 - INFO - Iteration 03: mean NCC = 0.6966
2025-07-23 23:32:22,913 - INFO - Iteration 04: mean NCC = 0.7168
2025-07-23 23:32:22,914 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,914 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,915 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,926 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,930 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,933 - INFO - Processing emitter 32/38 at (384, 412)
2025-07-23 23:32:22,944 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:22,949 - INFO - Iteration 01: mean NCC = -0.0895
2025-07-23 23:32:22,955 - INFO - Iteration 02: mean NCC = 0.6324
2025-07-23 23:32:22,960 - INFO - Iteration 03: mean NCC = 0.6968
2025-07-23 23:32:22,965 - INFO - Iteration 04: mean NCC = 0.7174
2025-07-23 23:32:22,965 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:22,965 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:22,967 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:22,977 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:22,982 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:22,984 - INFO - Processing emitter 33/38 at (212, 404)
2025-07-23 23:32:22,996 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:23,001 - INFO - Iteration 01: mean NCC = -0.0891
2025-07-23 23:32:23,007 - INFO - Iteration 02: mean NCC = 0.6320
2025-07-23 23:32:23,012 - INFO - Iteration 03: mean NCC = 0.6961
2025-07-23 23:32:23,017 - INFO - Iteration 04: mean NCC = 0.7168
2025-07-23 23:32:23,017 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:23,017 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:23,019 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:23,029 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:23,034 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:23,036 - INFO - Processing emitter 34/38 at (230, 105)
2025-07-23 23:32:23,048 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:23,053 - INFO - Iteration 01: mean NCC = -0.0887
2025-07-23 23:32:23,059 - INFO - Iteration 02: mean NCC = 0.6332
2025-07-23 23:32:23,064 - INFO - Iteration 03: mean NCC = 0.6957
2025-07-23 23:32:23,069 - INFO - Iteration 04: mean NCC = 0.7164
2025-07-23 23:32:23,070 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:23,070 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:23,071 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:23,082 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:23,086 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:23,088 - INFO - Processing emitter 35/38 at (404, 485)
2025-07-23 23:32:23,101 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:23,106 - INFO - Iteration 01: mean NCC = -0.0878
2025-07-23 23:32:23,111 - INFO - Iteration 02: mean NCC = 0.6371
2025-07-23 23:32:23,117 - INFO - Iteration 03: mean NCC = 0.6960
2025-07-23 23:32:23,122 - INFO - Iteration 04: mean NCC = 0.7173
2025-07-23 23:32:23,122 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:23,122 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:23,124 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:23,134 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:23,138 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:23,141 - INFO - Processing emitter 36/38 at (127, 146)
2025-07-23 23:32:23,153 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:23,159 - INFO - Iteration 01: mean NCC = -0.0869
2025-07-23 23:32:23,164 - INFO - Iteration 02: mean NCC = 0.6388
2025-07-23 23:32:23,169 - INFO - Iteration 03: mean NCC = 0.6952
2025-07-23 23:32:23,175 - INFO - Iteration 04: mean NCC = 0.7173
2025-07-23 23:32:23,175 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:23,175 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:23,176 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:23,187 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:23,191 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:23,194 - INFO - Processing emitter 37/38 at (422, 383)
2025-07-23 23:32:23,206 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:23,211 - INFO - Iteration 01: mean NCC = -0.0837
2025-07-23 23:32:23,217 - INFO - Iteration 02: mean NCC = 0.6419
2025-07-23 23:32:23,222 - INFO - Iteration 03: mean NCC = 0.6956
2025-07-23 23:32:23,227 - INFO - Iteration 04: mean NCC = 0.7204
2025-07-23 23:32:23,228 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:23,228 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:23,229 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:23,240 - INFO -   Fitted Gaussian sigma = 10.00 px
2025-07-23 23:32:23,244 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:23,247 - INFO - Processing emitter 38/38 at (338, 46)
2025-07-23 23:32:23,260 - INFO - Starting Gerchberg–Saxton iterations...
2025-07-23 23:32:23,265 - INFO - Iteration 01: mean NCC = -0.0825
2025-07-23 23:32:23,271 - INFO - Iteration 02: mean NCC = 0.6461
2025-07-23 23:32:23,276 - INFO - Iteration 03: mean NCC = 0.6963
2025-07-23 23:32:23,281 - INFO - Iteration 04: mean NCC = 0.7207
2025-07-23 23:32:23,281 - INFO - Stopping early – similarity threshold reached.
2025-07-23 23:32:23,281 - INFO - Generating final predicted PSFs...
2025-07-23 23:32:23,283 - INFO - Applying OTF Gaussian low-pass regularization...
2025-07-23 23:32:23,284 - INFO -   Fitted Gaussian sigma = 3.00 px
2025-07-23 23:32:23,289 - INFO - Performing Zernike decomposition...
2025-07-23 23:32:23,291 - INFO - Building full-field Zernike coefficient maps...
2025-07-23 23:32:36,839 - INFO - Zernike maps figure saved to result/zernike_phase_maps.png
2025-07-23 23:32:37,317 - INFO - Random emitters Zernike coefficients figure saved to result/zernike_coefficients_random.png
2025-07-23 23:32:37,324 - INFO - Results saved to result/result.h5
2025-07-23 23:32:37,324 - INFO - Processing completed.
2025-07-23 23:32:37,330 - INFO - 相位恢复流程完成！
